var handleUrl=function(smid, guid){let filename=`C400${smid}.m4a`;let cbName=getCb();let url=`https://c.y.qq.com/base/fcgi-bin/fcg_music_express_mobile3.fcg?format=json&cid=205361747&uin=0&songmid=${smid}&filename=${filename}&guid=${guid}&callback=${cbName}`;return url;};var getCb=function(){return Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 3);};var getJSONP=function(url) {var createScript=function(url){let script=document.createElement('script');script.setAttribute('src', url);document.body.appendChild(script);return script;};return new Promise((resolve, reject) => {const cbName=url.match(/.*?callback=(.*)/)[1];window[cbName]=function(data){resolve(data);};const script=createScript(url);script.onerror=function(){reject('error');};});};var getMusic=async function(smid){let guid=Math.floor(Math.random() * 2147483647) * Math.floor(Date.now() * 1000) % 10000000000;let url=handleUrl(smid, guid);let info=await getJSONP(url);let filename=info.data.items[0].filename;let vkey=info.data.items[0].vkey;return `https://dl.stream.qqmusic.qq.com/${filename}?vkey=${vkey}&guid=${guid}&uin=0&fromtag=66`;}
